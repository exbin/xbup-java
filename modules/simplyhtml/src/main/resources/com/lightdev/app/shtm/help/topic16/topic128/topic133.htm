<html>
  <head>
    <link href="../../style.css" rel="stylesheet" type="text/css">
    <title>    </title>
    
  </head>
  <body>
    <p class="heading1">
      Making the GUI available to the user
    </p>
    <p>
      As functionality and GUI for manipulation of image references as 
      described in <a href="../../topic16/topic128/topic130.htm">previous 
      chapters</a> is present, a way to use it is needed in addition.
    </p>
    <p class="heading2">
      Actions InsertImage and FormatImage
    </p>
    <p>
      Similar to the procedure used in previous stages, two actions are added 
      to class <font face="'Courier New',Monospaced,Monospace">FrmMain</font> 
      as inner classes. The new actions are added to the <font face="'Courier New',Monospaced,Monospace">
DynamicResource</font> instance of class <font face="'Courier New',Monospaced,Monospace">
FrmMain</font> with method <font face="'Courier New',Monospaced,Monospace">
      initActions</font> (see the documentation of <a href="../../topic16/topic62.htm">
stage 2</a> and <a href="../../topic16/topic103.htm">stage 5</a> for a 
      detailed description of actions and dynamic resources).
    </p>
    <p>
      Actions <font face="'Courier New',Monospaced,Monospace">InsertImageAction</font>
 and <font face="'Courier New',Monospaced,Monospace">FormatImageAction</font> 
      both create an instance of class <font face="'Courier New',Monospaced,Monospace"><a href="../../topic16/topic128/topic130.htm">
ImageDialog</a></font>. <font face="'Courier New',Monospaced,Monospace">
      FormatImageAction</font> shows the dialog reflecting settings for an 
      image currently selected in the editor to allow for attribute 
      adjustments or to change the image file. <font face="'Courier New',Monospaced,Monospace">
InsertImageAction</font> brings up the dialog to select a file from the image 
      repository and adjust attributes.
    </p>
    <p class="heading2">
      How image settings are applied
    </p>
    <p>
      When a selection is made in class <font face="'Courier New',Monospaced,Monospace">
ImageDialog</font> <font face="'Courier New',Monospaced,Monospace">
      InsertImageAction</font> applies the settings with the help of method <font face="'Courier New',Monospaced,Monospace">
insertBeforeStart</font> of class <font face="'Courier New',Monospaced,Monospace">
HTMLDocument</font>. The chosen image from class <font face="'Courier New',Monospaced,Monospace">
ImageDialog</font> is taken as HTML code got from method <font face="'Courier New',Monospaced,Monospace">
getImageHTML</font> and passed to method <font face="'Courier New',Monospaced,Monospace">
insertBeforeStart</font>.
    </p>
    <p>
      When an existing image reference is changed with <font face="'Courier New',Monospaced,Monospace">
FormatImageAction</font>, method <font face="'Courier New',Monospaced,Monospace">
getImageHTML</font> is used to get the image settings as HTML code again. The 
      HTML code is passed to method <font face="'Courier New',Monospaced,Monospace">
setOuterHTML</font> of class <font face="'Courier New',Monospaced,Monospace">
      HTMLDocument</font> in this case, replacing the changed image reference.
    </p>
  </body>
</html>
