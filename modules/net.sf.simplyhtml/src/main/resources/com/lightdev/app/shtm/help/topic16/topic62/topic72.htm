<html>
  <head>
    <link href="../../style.css" rel="stylesheet" type="text/css">
    
  </head>
  <body>
    <p class="heading1">
      Implementing drag and drop
    </p>
    <p>
      Drag and drop more or less is cut and paste without having to use the 
      menu. As SimplyHTML has implemented <a href="../../topic16/topic62/topic69.htm">
cut and paste for styled text and HTML text</a> in stage 2, it has the basis 
      for drag and drop too.
    </p>
    <p class="heading3">
      Typical drag an drop
    </p>
    <p>
      A typical drag and drop operation in the editor would act as follows: By 
      selecting text in the editor and by dragging the selection with the 
      mouse, a copy operation is initiated. Once the selection is dropped 
      anywhere else in the editor, the selection is removed from the original 
      location and pasted at the new location.
    </p>
    <p>
      To implement drag and drop a mechanism has to be implemented to 
      recognize drag and drop activities and to react in the described way.
    </p>
    <p class="heading3">
      The Java Tutorial
    </p>
    <p>
      There is a good example about how to implement drag and drop in The Java 
      Tutorial. The drag and drop example is well explained there already. At 
      this point therefore only some more general aspects are discussed only.
    </p>
    <p>
      The Java Tutorial is available online at <font color="#3333ff">
      http://java.sun.com/docs/books/tutorial/</font>
    </p>
    <p>
      <b>Note</b>: In J2SE 1.4 the original drag and drop is simplyfied by 
      wrapping the 'old' implementation into class TransferHandler partly but 
      as SimplyHTML shall be available to users of the 1.3 Runtime, the 'old' 
      mechanism is implemented which in fact does the same as the 'new' one.
    </p>
    <p class="heading2">
      Drag and drop in SimplyHTML
    </p>
    <p>
      Class <font face="'Courier New',Monospaced,Monospace">SHTMLEditorPane</font>
 has been created in this stage to allow for own cut and paste handling. For 
      drag and drop support it has an additional section in the source code. 
      The main parts of the drag and drop implementation are methods
    </p>
    <ul>
      <li>
        <font face="'Courier New',Monospaced,Monospace">initDnd</font>
      </li>
      <li>
        <font face="'Courier New',Monospaced,Monospace">dragGestureRecognized</font>

      </li>
      <li>
        <font face="'Courier New',Monospaced,Monospace">drop</font> and
      </li>
      <li>
        <font face="'Courier New',Monospaced,Monospace">doDrop</font>
      </li>
    </ul>
    <p class="heading3">
      Method initDnd
    </p>
    <p>
      Method <font face="'Courier New',Monospaced,Monospace">initDnd</font> 
      instantiates the objects necessary to control our drag and drop 
      implementation: <font face="'Courier New',Monospaced,Monospace">
      DragSource</font> and <font face="'Courier New',Monospaced,Monospace">
      DropTarget</font>. The <font face="'Courier New',Monospaced,Monospace">
      SHTMLEditorPane</font> registers itself as a <font face="'Courier New',Monospaced,Monospace">
DropTarget</font> and as a <font face="'Courier New',Monospaced,Monospace">
      DropTargetListener</font>. In <font face="'Courier New',Monospaced,Monospace">
DragSource</font> <font face="'Courier New',Monospaced,Monospace">SHTMLEditPane</font>
 registers itself as a <font face="'Courier New',Monospaced,Monospace">
      DragGestureRecognizer</font>. As well it registers as a <font face="'Courier New',Monospaced,Monospace">
MouseListener</font> to keep track of the selection during drag and drop 
      operations.
    </p>
    <p class="heading3">
      Method dragGestureRecognized
    </p>
    <p>
      <font face="'Courier New',Monospaced,Monospace">dragGestureRecognized</font>
 is the method <font face="'Courier New',Monospaced,Monospace">SHTMLEditorPane</font>
 has to implement to be a <font face="'Courier New',Monospaced,Monospace">
      DragGestureRecognizer</font>. The method is invoked by all drag 
      initiating gestures on <font face="'Courier New',Monospaced,Monospace">
      SHTMLEditorPane</font>.
    </p>
    <p>
      In method <font face="'Courier New',Monospaced,Monospace">
      dragGestureRecognized</font> an <font face="'Courier New',Monospaced,Monospace">
HTMLText</font> object is created on the currently selected text and an <font face="'Courier New',Monospaced,Monospace">
HTMLTextSelection</font> <a href="../../topic16/topic62/topic65.htm">
      transferable</a> is created wrapping the <font face="'Courier New',Monospaced,Monospace">
HTMLText</font> object. Finally the drag operation is initiated by invoking 
      method <font face="'Courier New',Monospaced,Monospace">
      DragSource.startDrag</font> with the newly created transferable.
    </p>
    <p class="heading3">
      Method drop
    </p>
    <p>
      Once a drop event is recognized, method drop is invoked. In SimplyHTML 
      it calls method <font face="'Courier New',Monospaced,Monospace">doDrop</font>
 if a suitable <font face="'Courier New',Monospaced,Monospace"><a href="../../topic16/topic62/topic65.htm">
DataFlavor</a></font> (<font face="'Courier New',Monospaced,Monospace">HTMLText</font>
 or <font face="'Courier New',Monospaced,Monospace">String</font>) is found in 
      the dragged element. Otherwise the drop is rejected.
    </p>
    <p class="heading3">
      Method doDrop
    </p>
    <p>
      Method <font face="'Courier New',Monospaced,Monospace">doDrop</font> 
      does the actual cut and paste resulting from the drag and drop operation 
      consisting of adding the dragged element and necessarily removing the 
      dragged element from the original position.
    </p>
  </body>
</html>
